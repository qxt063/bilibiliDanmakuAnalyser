# -*- coding: utf-8 -*-

from getBilibiliDanmaku import *

if __name__ == '__main__':
    # videoInformation = getCidAndAid(getVideoHtmlByAid(input("输入av号：")))
    # danmakuSource = getDanmakuHtml(videoInformation)
    danmakuSource = """<d p="27.16000,1,25,16777215,1525431206,0,a7bcb48b,4510124482">播放量1截图</d>
<d p="1.32700,1,25,16777215,1525431229,0,51f9133f,4510125500">好前</d>
<d p="14.71300,1,25,16777215,1525431238,0,11304c4e,4510125935">火钳刘明</d>
<d p="1.48300,1,25,16777215,1525431248,0,b6a7e9dc,4510126353">封面真好看</d>
<d p="1.58700,1,25,16777215,1525431256,0,7054396b,4510126749">看到动点P调的龙牙就进来了</d>
<d p="55.00100,1,25,16777215,1525431273,0,878636d2,4510127506">好听好听好听好听好听好听！！！</d>
<d p="9.20000,1,25,16777215,1525431289,0,732cc680,4510128288">前！嗷</d>
<d p="108.44600,1,25,16777215,1525431290,0,bab20e16,4510128317">啊 太好听了 倒地</d>
<d p="28.75900,1,25,38979,1525431316,0,34c6b814,4510129535">牙哥！牙哥！！</d>
<d p="3.99300,1,25,16777215,1525431329,0,4370a6a,4510130115">前前前</d>
<d p="32.94500,1,25,38979,1525431332,0,732cc680,4510130268">帅炸</d>
<d p="55.54500,1,25,16777215,1525431351,0,3f1958a7,4510131173">握草</d>
<d p="61.82800,1,25,16777215,1525431358,0,3f1958a7,4510131454">这调教</d>
<d p="81.45100,1,25,16777215,1525431377,0,3f1958a7,4510132406">神了，这调教</d>
<d p="86.38700,1,25,16777215,1525431382,0,708d9877,4510132651">假音牙真的美fly</d>
<d p="16.67000,1,25,16777215,1525431401,0,f05a71c7,4510133522">打call！</d>
<d p="92.11300,4,25,38979,1525431428,0,732cc680,4510134785">黑白转彩色了</d>
<d p="51.20900,1,25,16777215,1525431440,0,8f289d22,4510135315">哇喔哇喔</d>
<d p="77.90800,1,25,16777215,1525431480,0,5598e3cb,4510137171">哇啊 啊 啊啊啊啊</d>
<d p="165.41800,1,25,16777215,1525431509,0,4370a6a,4510138520">才发现宝石颜色渐渐出现了！</d>
<d p="35.40500,1,25,16777215,1525431528,0,a81905c5,4510139453">啊啊啊啊啊啊</d>
<d p="42.53500,1,25,16777215,1525431535,0,a81905c5,4510139819">吹爆！！！</d>
<d p="4.22400,1,25,16777215,1525431537,0,e16fd3e9,4510139901">前</d>
<d p="211.87400,1,25,16777215,1525431561,0,732cc680,4510141079">承包这个笑容嗷嗷嗷嗷</d>
<d p="18.06300,1,25,16777215,1525431569,0,e16fd3e9,4510141493">六分前</d>
<d p="112.06100,1,25,16777215,1525431576,0,20f35bdf,4510141811">杰里杰气的，动点的调教太棒啦！！！</d>
<d p="225.82200,1,25,16777215,1525431604,0,b739379e,4510143192">他笑起来好好看！！！！</d>
<d p="67.85900,1,25,16777215,1525431608,0,a81905c5,4510143400">童话说雨后会有一道彩虹</d>
<d p="29.42600,1,25,16777215,1525431611,0,93735c24,4510143578">纵横华语乐坛的牙哥</d>
<d p="73.14500,1,25,16777215,1525431662,0,a81905c5,4510146057">却不曾说过它也会转瞬成空</d>
<d p="34.46800,1,25,16777215,1525431681,0,70da57f6,4510146914">终于！！！</d>
<d p="85.29500,1,25,41194,1525431700,0,1a37b5ef,4510147815">我爱牙牙！副歌简直太好听了！！</d>
<d p="209.62600,1,25,16777215,1525431716,0,1c1efb75,4510148558">彩色越来越漂亮了</d>
<d p="82.17300,1,25,16777215,1525431723,0,a81905c5,4510148858">想要把绚烂紧紧握在手中</d>
<d p="9.23900,1,25,16777215,1525431726,0,3bd59b8,4510149029">呀好帅！！！</d>"""
    danmakuList = getDanmaku(danmakuSource)

    pretendVideoInfo = {'cid': 21551703, 'aid': 21551703, 'title': '【洛天依原创曲】绝体绝命【PV付】'}
    poseAsAPath = 'K:/test/danmaku/danmaku.xls'
    writeDanmakuToExcel(pretendVideoInfo, danmakuList, poseAsAPath)
    # for danmaku in danmakuList:
    #     printDanmaku(danmaku)
    #     print()
